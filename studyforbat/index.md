## 索引  

#### 索引概念
Innodb将数据按某些列有序存放在数据页中，而这些数据页会形成一个双向链表并且，     
下一页中该列的值必须大于上一页中该列的值。为了提升查询效率，把每一页中该列  
的最小值和页编号拿出来形成一个个目录项记录，按存储用户记录同样的方式也存放  
数据页中，这些目录项就是索引。只有最下层存放的是用户记录的页，其他层都是目    
录项记录页。这样的树状结构就是B+树    
![tree!](/studyforbat/pic/tree.png "树")   

#### B+树
从上图我们可以看出，无论是用户记录的页，还是目录项记录的页我们都把他存放在  
在了树中。我们把这些页叫做节点。最底层的节点为叶子节点，其他非叶子子节点称  
为内节点。最上层那个节点为根节点。  

#### 聚簇索引  
- 一般为主键或唯一索引列，innodb会自动创建聚簇索引叶子节点内存放了完整的用户记录  
- 使用记录主键或唯一性索引进行记录和页排序。
    - 页内的记录按照逐渐排序成单项链表
    - 用户记录页之间也按住键排序成双向链表
    - 存放目录项记录的页分为不同层次，同一层次中页也根据页中目录项记录中的主键排序  
    成双向链表

#### 二级索引  
一其他列作为规则建立起来的B+树索引结构，目录项中除了索引列和页号之外，为了保证目录项  
的唯一性，还会存放主键值。叶子节点存放的是索引列和主键值。如果需要查找用户记录还需拿  
到主键值后再去聚簇索引中进行查询。  

#### 联合索引  
在多个列上建立的二级索引。例如（a,b）这个联合索引，会先根据a进行排序，然后在此基础上  
在按b排序。

#### 页存放
一个页中最少可以存放两条记录

#### Myisam索引  
将数据和索引分别存放在两个文件，把记录按顺序写入数据文件中。索引结构中的叶子节点存放的  
是主键值和记录行号。先通过索引拿到行号，再去数据文件中拿到数据。如果行格式为定长，也就  
是每行占用的空间是固定的，则可以很方便算出数据偏移量，通过偏移量可以很快拿到数据。